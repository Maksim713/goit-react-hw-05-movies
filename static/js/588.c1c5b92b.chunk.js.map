{"version":3,"file":"static/js/588.c1c5b92b.chunk.js","mappings":"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","sources":["hooks/useOriginPath.js","webpack://cinesearch/./src/pages/Movies/Movies.module.css?82ee","webpack://cinesearch/./src/components/MoviesSearchList/MoviesSearchList.module.css?457d","components/MoviesSearchList/MoviesSearchList.jsx","pages/Movies/Movies.jsx","pages/Movies/useSearch.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport { useLocation } from 'react-router-dom';\n\nexport const useOriginPath = () => {\n  const { pathname } = useLocation();\n  const originPath = useRef(pathname);\n  useEffect(() => {\n    if (originPath.current !== '') return;\n    originPath.current = pathname;\n  }, [pathname]);\n  return originPath.current;\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"Movies_container__+-Cnt\",\"moreBtn\":\"Movies_moreBtn__-8L4E\"};","// extracted by mini-css-extract-plugin\nexport default {\"catalogFilms\":\"MoviesSearchList_catalogFilms__ebybB\",\"catalogCard\":\"MoviesSearchList_catalogCard__+Nepi\"};","import { useOriginPath } from 'hooks/useOriginPath';\nimport { NavLink } from 'react-router-dom';\nimport css from './MoviesSearchList.module.css';\n\nfunction MoviesSearchList({ movies }) {\n  const originPath = useOriginPath();\n\n  return (\n    <ul className={css.catalogFilms}>\n      {movies.map(({ id, title }) => (\n        <li key={id} className={css.catalogCard}>\n          <NavLink to={`${originPath}/${id}`}>{title}</NavLink>\n        </li>\n      ))}\n    </ul>\n  );\n}\n\nexport default MoviesSearchList;\n","import { moviesSearchValueCtx } from 'context/moviesSearchValueCtx ';\nimport { useContext, useEffect, useState } from 'react';\nimport css from './Movies.module.css';\nimport Container from 'components/Container/Container';\nimport MoviesSearchList from 'components/MoviesSearchList/MoviesSearchList';\nimport { useSearch } from './useSearch';\n\nfunction Movies() {\n  const { search, setTotalResults, setMoviesCount, updateMovies } =\n    useContext(moviesSearchValueCtx);\n  const { error, loading, page, setPage, movies, totalPages, totalResults } =\n    useSearch({ search });\n  const [searchResults, setSearchResults] = useState([]);\n\n  useEffect(() => {\n    setPage(1);\n  }, [search, setPage]);\n\n  useEffect(() => {\n    localStorage.setItem('previousPage', '/movies');\n  }, []);\n\n  useEffect(() => {\n    setMoviesCount(movies.length);\n    setTotalResults(totalResults);\n    setSearchResults(movies);\n    updateMovies(movies);\n  }, [\n    searchResults,\n    setMoviesCount,\n    setTotalResults,\n    totalResults,\n    movies,\n    updateMovies,\n  ]);\n\n  return (\n    <div className={css.container}>\n      <Container>\n        {!error && searchResults?.length > 0 && (\n          <MoviesSearchList movies={searchResults} />\n        )}\n        {error && <div>Error: {error}</div>}\n        {loading && <div>Loading...</div>}\n        {!loading && !error && page < totalPages && (\n          <button className={css.moreBtn} onClick={() => setPage(p => p + 1)}>\n            More {page}/{totalPages}\n          </button>\n        )}\n      </Container>\n    </div>\n  );\n}\n\nexport default Movies;\n","import { useEffect, useRef, useState } from 'react';\nimport { searchMovie } from '../../services/themoviedbApi';\n\nexport const useSearch = ({ search }) => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [movies, setMovies] = useState([]);\n\n  const [totalResults, setTotalResults] = useState(0);\n  const [page, setPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(null);\n\n  const searchRef = useRef(search);\n  const pageRef = useRef(page);\n\n  useEffect(() => {\n    if (search === '') return;\n    if (searchRef.current === search && pageRef.current === page) {\n      setError(`Change your search \"${search}\" by new, please.`);\n      return;\n    }\n    searchRef.current = search;\n    setLoading(true);\n    searchMovie(search, page)\n      .then(data => {\n        const {\n          results,\n          total_pages: totalPages,\n          total_results: totalResults,\n        } = data;\n        if (totalResults === 0) {\n          throw new Error(\n            `Your search \"${search}\" brought result: 0. Change it.`\n          );\n        }\n        setError(null);\n        setMovies(p =>\n          searchRef.current === search ? [...results] : [...p, ...results]\n        );\n        setTotalResults(totalResults);\n        setTotalPages(totalPages);\n      })\n      .catch(e => {\n        setError(e.message);\n        setMovies([]);\n        setPage(1);\n      })\n      .finally(() => setLoading(false));\n    return () => {};\n  }, [search, page, setTotalResults]);\n\n  return { error, loading, page, setPage, movies, totalPages, totalResults };\n};\n"],"names":["useOriginPath","pathname","useLocation","originPath","useRef","useEffect","current","movies","className","css","map","id","title","to","useContext","moviesSearchValueCtx","search","setTotalResults","setMoviesCount","updateMovies","useState","loading","setLoading","error","setError","setMovies","totalResults","page","setPage","totalPages","setTotalPages","searchRef","pageRef","searchMovie","then","data","results","total_pages","total_results","Error","p","catch","e","message","finally","useSearch","searchResults","setSearchResults","localStorage","setItem","length","Container","onClick"],"sourceRoot":""}